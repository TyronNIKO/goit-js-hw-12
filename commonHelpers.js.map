{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/img/icons/info.svg","../src/img/icons/icon-error.svg","../src/js/render-function.js","../src/js/js-loader.js","../src/js/scrollItems.js","../src/js/loadMoreBtn.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n// export async function pixabayRequestNew(searchParams, container) {\nexport async function pixabayRequest(searchParams) {\n  const response = await axios.get(`https://pixabay.com/api/?${searchParams}`);\n  return response.data;\n}\n","export default \"__VITE_ASSET__98ffb9cc__\"","export default \"__VITE_ASSET__eb775c6f__\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport info from '/img/icons/info.svg';\nimport error from '/img/icons/icon-error.svg';\n\nconst icons = {\n  info,\n  error,\n};\n\nconst galleryItem = new SimpleLightbox('.gallery li a');\n\nexport function showError(type, text) {\n  const colors = { error: 'red', info: 'blue', success: 'green' };\n  const color = colors[type.toLowerCase()];\n\n  iziToast.show({\n    title: `${type}`,\n    color: color,\n    maxWidth: window.innerWidth < 768 ? '100%' : '33%',\n    iconUrl: icons[type.toLowerCase()],\n    position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n    message: `${text}`,\n  });\n}\nfunction createItem(obj) {\n  return `<li>\n            <a href=\"${obj.largeImageURL}\"><img src='${obj.webformatURL}' alt='${obj.tags}'></a>\n            <div class=\"content\">\n                <div class=\"item\"><h3>Likes</h3><p>${obj.likes}</p></div>\n                <div class=\"item\"><h3>Views</h3><p>${obj.views}</p></div>\n                <div class=\"item\"><h3>Comments</h3><p>${obj.comments}</p></div>\n                <div class=\"item\"><h3>Downloads</h3><p>${obj.downloads}</p></div>\n            </div>\n        </li>`;\n}\nexport function createMarkup(array) {\n  return array.map(photo => createItem(photo)).join('');\n}\nexport function clearMarkup(container) {\n  container.innerHTML = '';\n}\nexport function renderMarkup(markup, container) {\n  container.insertAdjacentHTML('beforeend', markup);\n  galleryItem.refresh();\n}\n","export default class JsLoader {\n  constructor() {\n    this.element = document.querySelector('.js-loader-text');\n    this.options = {\n      text: 'Loading images, please wait',\n      loader: '.',\n      count: 3,\n    };\n  }\n  show() {\n    // console.log('New interval');\n    // console.log(this);\n    this.element.classList.remove('js-hidden');\n    let acc = 0;\n    this.interval = setInterval(() => {\n      if (acc > this.options.count) acc = 0;\n      this.element.innerText = this.options.text.padEnd(\n        this.options.text.length + acc,\n        this.options.loader\n      );\n      acc++;\n    }, 200);\n  }\n  remove() {\n    // console.log('Interval cleared', id);\n    clearInterval(this.interval);\n    this.element.classList.add('js-hidden');\n  }\n}\n","export function scrollItems() {\n  const firstItem = document.querySelector('.gallery li');\n  if (firstItem) {\n    const { height } = firstItem.getBoundingClientRect();\n    window.scrollBy({ top: (height + 20) * 2, behavior: 'smooth' });\n  }\n}\n","export const loadMore = {\n  btn: document.querySelector('button[data-request=\"load-more\"]'),\n  show() {\n    loadMore.btn.classList.remove('js-hidden');\n  },\n  hide() {\n    loadMore.btn.classList.add('js-hidden');\n  },\n};\n","import { pixabayRequest } from './js/pixabay-api';\nimport {\n  createMarkup,\n  renderMarkup,\n  clearMarkup,\n  showError,\n} from './js/render-function';\nimport JsLoader from './js/js-loader';\nimport { scrollItems } from './js/scrollItems';\nimport { loadMore } from './js/loadMoreBtn';\n\nconst REFS = {\n  form: document.querySelector('form'),\n  gallery: document.querySelector('.photo-list'),\n};\nconst ERROR = {\n  inputEmpty: 'Search input must be filled!',\n  noData: \"We're sorry, but you've reached the end of search results.\",\n  wrongInput:\n    'Sorry, there are no images matching your search query. Please try again!',\n};\n\nconst jsLoader = new JsLoader();\n\nlet searchParams = new URLSearchParams({\n  key: '7706316-da1567048322714709989c4f8',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 15,\n});\nlet OPTIONS = {\n  request_page: 1,\n  perPage: searchParams.get('per_page'),\n};\nconst validateData = {\n  pageLimit(data) {\n    OPTIONS.limit = Math.ceil(data.totalHits / OPTIONS.perPage);\n    return OPTIONS.request_page >= OPTIONS.limit;\n  },\n  hits(data) {\n    return !data.hits || data.hits.length == 0;\n  },\n};\n\nfunction handleError(message, error) {\n  console.log(error);\n  showError('Error', message);\n  jsLoader.remove();\n}\n\nfunction handleData(data, more) {\n  if (validateData.hits(data)) {\n    handleError(ERROR.noData, new Error('No data'));\n    loadMore.hide();\n    clearMarkup(REFS.gallery);\n    return;\n  }\n\n  if (!more) clearMarkup(REFS.gallery);\n  renderMarkup(createMarkup(data.hits), REFS.gallery, false);\n\n  if (validateData.pageLimit(data)) {\n    loadMore.hide();\n    throw new Error('No more pages');\n  } else {\n    loadMore.show();\n  }\n}\n\nasync function fetchData(message, more) {\n  jsLoader.show();\n  setTimeout(async () => {\n    try {\n      const data = await pixabayRequest(searchParams);\n      handleData(data, more);\n      jsLoader.remove();\n    } catch (error) {\n      handleError(message, error);\n    }\n  }, 2000);\n}\n\n//SUBMIT or NEW SEARCH\nREFS.form.addEventListener('submit', async e => {\n  e.preventDefault();\n  OPTIONS.request_page = 1;\n  const inputValue = REFS.form.elements[0].value.trim();\n  if (!inputValue) {\n    showError('Info', ERROR.inputEmpty);\n    return;\n  }\n  searchParams.set('q', inputValue);\n  searchParams.set('page', 1);\n\n  await fetchData(ERROR.noData, false);\n});\n//CLICK or LOAD MORE\nloadMore.btn.addEventListener('click', async e => {\n  e.preventDefault();\n  loadMore.hide();\n  searchParams.set('page', ++OPTIONS.request_page);\n\n  await fetchData(ERROR.wrongInput, true);\n  scrollItems();\n});\n"],"names":["pixabayRequest","searchParams","axios","info","error","icons","galleryItem","SimpleLightbox","showError","type","text","color","iziToast","createItem","obj","createMarkup","array","photo","clearMarkup","container","renderMarkup","markup","JsLoader","acc","scrollItems","firstItem","height","loadMore","REFS","ERROR","jsLoader","OPTIONS","validateData","data","handleError","message","handleData","more","fetchData","inputValue"],"mappings":"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"}