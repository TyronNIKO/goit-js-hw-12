{"version":3,"file":"commonHelpers.js","sources":["../src/img/icons/info.svg","../src/img/icons/icon-error.svg","../src/js/render-function.js","../src/js/js-loader.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__98ffb9cc__\"","export default \"__VITE_ASSET__eb775c6f__\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport info from '/img/icons/info.svg';\nimport error from '/img/icons/icon-error.svg';\n\nconst icons = {\n  info,\n  error,\n};\n\nconst galleryItem = new SimpleLightbox('.gallery li a');\n\nexport function showError(type, text) {\n  const colors = { error: 'red', info: 'blue', success: 'green' };\n  const color = colors[type.toLowerCase()];\n\n  iziToast.show({\n    title: `${type}`,\n    color: color,\n    maxWidth: window.innerWidth < 768 ? '100%' : '33%',\n    iconUrl: icons[type.toLowerCase()],\n    position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n    message: `${text}`,\n  });\n}\nfunction createItem(obj) {\n  return `<li>\n                <a href=\"${obj.largeImageURL}\"><img src='${obj.webformatURL}' alt='${obj.tags}'></a>\n                <div class=\"content\">\n                    <div class=\"item\"><h3>Likes</h3><p>${obj.likes}</p></div>\n                    <div class=\"item\"><h3>Views</h3><p>${obj.views}</p></div>\n                    <div class=\"item\"><h3>Comments</h3><p>${obj.comments}</p></div>\n                    <div class=\"item\"><h3>Downloads</h3><p>${obj.downloads}</p></div>\n                </div>\n            </li>`;\n}\nexport async function renderPhoto(photos, container, more) {\n  const markup = photos.hits.map(photo => createItem(photo)).join('');\n  if (!more) container.textContent = '';\n  container.insertAdjacentHTML('beforeend', markup);\n  galleryItem.refresh();\n}\n","export default class JsLoader {\n  constructor() {\n    this.element = document.querySelector('.js-loader-text');\n    this.options = {\n      text: 'Loading images, please wait',\n      loader: '.',\n      count: 3,\n    };\n  }\n\n  createInterval({ count, text, loader }) {\n    // console.log('New interval');\n    // console.log(this);\n    this.element.classList.remove('js-hidden');\n    let acc = 0;\n    this.interval = setInterval(() => {\n      if (acc > count) acc = 0;\n      this.element.innerText = text.padEnd(text.length + acc, loader);\n      acc++;\n    }, 200);\n  }\n  removeInterval(id) {\n    // console.log('Interval cleared', id);\n    clearInterval(id);\n    this.element.classList.add('js-hidden');\n  }\n  init() {\n    this.element.classList.add('js-hidden');\n  }\n}\n","import { renderPhoto, showError } from './render-function';\nimport JsLoader from './js-loader';\n\n// export async function pixabayRequestNew(searchParams, container) {\nexport async function pixabayRequest(searchParams, container, more) {\n  //   console.log(more);\n  const jsLoader = new JsLoader();\n  jsLoader.createInterval(jsLoader.options);\n\n  //   await fetch(`https://pixabay.com/api/?${searchParams}`)\n  //     .then(response => {\n  //       if (!response.ok) {\n  //         throw new Error(response.status);\n  //       }\n  //       return response.json();\n  //     })\n  //     .then(photos => {\n  //       console.log(photos);\n  //       if (!photos.hits || photos.hits.length === 0)\n  //         throw new Error('Error! Nothing to load');\n  //       renderPhoto(photos, container, more).finally(() => {\n  //         let rect = document.querySelector('.gallery li');\n  //         rect = rect.getBoundingClientRect();\n  //         let gap = 20;\n  //         // console.log(rect, rect.height);\n  //         window.scrollBy({\n  //           top: (rect.height + gap) * 2,\n  //           behavior: 'smooth',\n  //         });\n  //       });\n  //     })\n  //     .catch(error => {\n  //       showError(\n  //         'Error',\n  //         !more\n  //           ? 'Sorry, there are no images matching your search query. Please try again!'\n  //           : \"We're sorry, but you've reached the end of search results.\"\n  //       );\n  //     })\n  //     .finally(() => jsLoader.removeInterval(jsLoader.interval));\n\n  try {\n    const response = await fetch(`https://pixabay.com/api/?${searchParams}`);\n    if (!response.ok) throw new Error(response.status);\n\n    const photos = await response.json();\n    if (!photos.hits || photos.hits.length === 0)\n      throw new Error('Error! Nothing to load');\n\n    await renderPhoto(photos, container, more);\n\n    const firstItem = document.querySelector('.gallery li');\n    if (more && firstItem) {\n      const { height } = firstItem.getBoundingClientRect();\n      window.scrollBy({ top: (height + 20) * 2, behavior: 'smooth' });\n    }\n  } catch (error) {\n    showError(\n      'Error',\n      more\n        ? \"We're sorry, but you've reached the end of search results.\"\n        : 'Sorry, there are no images matching your search query. Please try again!'\n    );\n  } finally {\n    jsLoader.removeInterval(jsLoader.interval);\n  }\n}\n","import { pixabayRequest } from './js/pixabay-api';\nimport { showError } from './js/render-function';\nimport JsLoader from './js/js-loader';\n\nconst REFS = {\n  searchForm: document.querySelector('form'),\n  photoList: document.querySelector('.photo-list'),\n  loadMore: document.querySelector('button[data-request=\"load-more\"]'),\n};\n\nconst jsLoader = new JsLoader();\njsLoader.init();\n\nlet searchParams = new URLSearchParams({\n  key: '7706316-da1567048322714709989c4f8',\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 15,\n  //   per_page: 50,\n});\nlet REQUEST_PAGE = 1;\nREFS.searchForm.addEventListener('submit', e => {\n  e.preventDefault();\n  const inputValue = REFS.searchForm.elements[0].value.trim();\n  if (!inputValue) {\n    showError('Info', 'Search input must be filled!');\n    return;\n  }\n  searchParams.set('q', inputValue);\n  REQUEST_PAGE = 1;\n  pixabayRequest(searchParams, REFS.photoList, false).then(() => {\n    REFS.loadMore.classList.remove('js-hidden');\n  });\n});\n\nREFS.loadMore.addEventListener('click', e => {\n  e.preventDefault();\n  REFS.loadMore.classList.add('js-hidden');\n  searchParams.set('page', ++REQUEST_PAGE);\n  pixabayRequest(searchParams, REFS.photoList, true).then(() => {\n    REFS.loadMore.classList.remove('js-hidden');\n  });\n});\n"],"names":["info","error","icons","galleryItem","SimpleLightbox","showError","type","text","color","iziToast","createItem","obj","renderPhoto","photos","container","more","markup","photo","JsLoader","count","loader","acc","id","pixabayRequest","searchParams","jsLoader","response","firstItem","height","REFS","REQUEST_PAGE","e","inputValue"],"mappings":"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"}